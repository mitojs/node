# work in progress ğŸš§
æ­£åœ¨å¼€å‘ä¸­ï¼Œæ„Ÿå…´è¶£å¯ä»¥åŠ å…¥æˆ‘ä»¬
![é£ä¹¦ç¾¤](./docs/lark_group.jpg)

# MitoJS Node(README ç”± AI ç”Ÿæˆ)
ä¸€ä¸ªå¼ºå¤§çš„ Node.js æ€§èƒ½ç›‘æ§å’Œè°ƒè¯•å·¥å…·å¥—ä»¶ï¼Œæä¾›å®æ—¶æ€§èƒ½åˆ†æã€å†…å­˜ç›‘æ§å’Œä»£ç è°ƒè¯•åŠŸèƒ½ã€‚

## ğŸš€ ç‰¹æ€§

- **æ€§èƒ½åˆ†æ**: CPU æ€§èƒ½åˆ†æã€å †å¿«ç…§ã€å†…å­˜ä½¿ç”¨ç›‘æ§
- **å®æ—¶ç›‘æ§**: å®æ—¶ CPU ä½¿ç”¨ç‡ç›‘æ§
- **ä»£ç è°ƒè¯•**: æ”¯æŒåœ¨ç›®æ ‡è¿›ç¨‹ä¸­è¿è¡Œä»£ç 
- **è·¨å¹³å°**: æ”¯æŒ macOSã€Linuxã€Windows
- **CLI å·¥å…·**: æä¾›å‘½ä»¤è¡Œç•Œé¢ï¼Œæ˜“äºé›†æˆåˆ°å¼€å‘æµç¨‹
- **Rust ä»£ç†**: é«˜æ€§èƒ½çš„ Rust ä»£ç†ç¨‹åºï¼Œæä¾›ç¨³å®šçš„æ•°æ®å¤„ç†èƒ½åŠ›

## ğŸ“¦ åŒ…ç»“æ„

æœ¬é¡¹ç›®é‡‡ç”¨ monorepo æ¶æ„ï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŒ…ï¼š

- **@mitojs/node**: Node.js SDKï¼Œæä¾›æ€§èƒ½ç›‘æ§çš„æ ¸å¿ƒåŠŸèƒ½
- **@mitojs/node-cli**: å‘½ä»¤è¡Œå·¥å…·ï¼Œæä¾›äº¤äº’å¼çš„è°ƒè¯•å’Œç›‘æ§ç•Œé¢
- **agent**: Rust ç¼–å†™çš„é«˜æ€§èƒ½ä»£ç†ç¨‹åºï¼Œè´Ÿè´£æ•°æ®å¤„ç†å’Œ IPC é€šä¿¡

## ğŸ›  å®‰è£…ï¼ˆå¼€å‘ä¸­ï¼‰

### ä½¿ç”¨ npm

```bash
npm install @mitojs/node @mitojs/node-cli
```

### ä½¿ç”¨ pnpm

```bash
pnpm add @mitojs/node @mitojs/node-cli
```

### ä½¿ç”¨ yarn

```bash
yarn add @mitojs/node @mitojs/node-cli
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åœ¨ä½ çš„ Node.js åº”ç”¨ä¸­é›†æˆ SDK

```javascript
// åœ¨åº”ç”¨å…¥å£æ–‡ä»¶ä¸­å¼•å…¥
import '@mitojs/node'

// æˆ–è€…æ‰‹åŠ¨åˆå§‹åŒ–
import { init } from '@mitojs/node'

async function startApp() {
  await init()
  // ä½ çš„åº”ç”¨ä»£ç 
}

startApp()
```

### 2. ä½¿ç”¨ CLI å·¥å…·ç›‘æ§åº”ç”¨

```bash
# è·å–è¿›ç¨‹çš„ CPU æ€§èƒ½åˆ†æï¼ˆ10ç§’ï¼‰
mito-node cpuprofile -p <pid> -d 10000

# è·å–å †å¿«ç…§
mito-node heapsnapshot -p <pid> -d ./snapshots

# å®æ—¶ç›‘æ§ CPU ä½¿ç”¨ç‡
mito-node monitor-cpu -p <pid>

# è·å–å†…å­˜ä¿¡æ¯
mito-node memory -p <pid>

# åœ¨ç›®æ ‡è¿›ç¨‹ä¸­è¿è¡Œä»£ç 
mito-node run-code -p <pid> -c "console.log('Hello from target process')"

# ä»æ–‡ä»¶è¿è¡Œä»£ç 
mito-node run-code -p <pid> -f ./debug-script.js
```

## ğŸ“‹ CLI å‘½ä»¤è¯¦è§£

| å‘½ä»¤            | æè¿°                  | é€‰é¡¹                                                           |
| --------------- | --------------------- | -------------------------------------------------------------- |
| `cpuprofile`    | è·å– CPU æ€§èƒ½åˆ†ææ–‡ä»¶ | `-d, --duration <ms>` åˆ†ææŒç»­æ—¶é—´ï¼ˆé»˜è®¤10000msï¼‰              |
| `heapsnapshot`  | è·å–å †å¿«ç…§            | `-d, --dir <dir>` ä¿å­˜ç›®å½•ï¼ˆé»˜è®¤å½“å‰ç›®å½•ï¼‰                     |
| `memory`        | è·å–å†…å­˜ä½¿ç”¨ä¿¡æ¯      | æ—                                                              |
| `monitor-cpu`   | å®æ—¶ç›‘æ§ CPU ä½¿ç”¨ç‡   | æ—                                                              |
| `run-code`      | åœ¨ç›®æ ‡è¿›ç¨‹ä¸­æ‰§è¡Œä»£ç   | `-c, --code <code>` ä»£ç å­—ç¬¦ä¸²<br>`-f, --file <file>` ä»£ç æ–‡ä»¶ |
| `start-inspect` | å¼€å§‹è°ƒè¯•ç›®æ ‡è¿›ç¨‹      | æ—                                                              |
| `stop-inspect`  | åœæ­¢è°ƒè¯•ç›®æ ‡è¿›ç¨‹      | æ—                                                              |
| `report`        | ç”Ÿæˆè¿›ç¨‹æŠ¥å‘Š          | `-d, --dir <dir>` ä¿å­˜ç›®å½•ï¼ˆé»˜è®¤å½“å‰ç›®å½•ï¼‰                     |

## ğŸ— å¼€å‘

### ç¯å¢ƒè¦æ±‚

- Node.js >= 20
- pnpm >= 10
- Rust (ç”¨äºæ„å»º agent)

### å®‰è£…ä¾èµ–

```bash
pnpm install
```

### æ„å»ºé¡¹ç›®

```bash
# æ„å»ºæ‰€æœ‰åŒ…
pnpm build

# ä»…æ„å»º TypeScript
pnpm esm

# ä»…æ„å»º Rust agent
pnpm build:rust
```

### å¼€å‘æ¨¡å¼

```bash
# ç›‘å¬æ¨¡å¼æ„å»º
pnpm watch:esm

# å¯åŠ¨ React 19 ç¤ºä¾‹åº”ç”¨
pnpm web:dev
```

### è¿è¡Œæµ‹è¯•

```bash
pnpm test
```

## ğŸ› æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Node.js App   â”‚    â”‚   CLI Tool      â”‚    â”‚   Rust Agent    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚  @mitojs/node   â”‚â—„â”€â”€â–ºâ”‚@mitojs/node-cli â”‚â—„â”€â”€â–ºâ”‚   IPC + HTTP    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚   SDKé›†æˆ       â”‚    â”‚   å‘½ä»¤è¡Œç•Œé¢    â”‚    â”‚   æ•°æ®å¤„ç†      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

1. **Node.js SDK** (`@mitojs/node`)
   - è‡ªåŠ¨åˆå§‹åŒ– Rust ä»£ç†
   - æä¾›æ€§èƒ½ç›‘æ§ API
   - è·¨å¹³å°äºŒè¿›åˆ¶æ–‡ä»¶ç®¡ç†

2. **CLI å·¥å…·** (`@mitojs/node-cli`)
   - åŸºäº Commander.js çš„å‘½ä»¤è¡Œç•Œé¢
   - ä½¿ç”¨ Ink + React çš„äº¤äº’å¼ UI
   - WebSocket é€šä¿¡æ”¯æŒ

3. **Rust ä»£ç†** (`agent`)
   - é«˜æ€§èƒ½æ•°æ®å¤„ç†
   - IPC è¿›ç¨‹é—´é€šä¿¡
   - HTTP æœåŠ¡å™¨
   - è·¨å¹³å°ç¼–è¯‘æ”¯æŒ

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·æŸ¥çœ‹ [CONTRIBUTING.md](.github/CONTRIBUTING.md) äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚

## ğŸ“„ è®¸å¯è¯

MIT License - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚


